<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PubChemCrawler.jl</title><link rel="canonical" href="https://JuliaHealth.github.io/PubChemCrawler.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PubChemCrawler.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Before-you-start:-be-aware-of-search-limits"><span>Before you start: be aware of search limits</span></a></li><li><a class="tocitem" href="#Getting-started"><span>Getting started</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PubChemCrawler"><a class="docs-heading-anchor" href="#PubChemCrawler">PubChemCrawler</a><a id="PubChemCrawler-1"></a><a class="docs-heading-anchor-permalink" href="#PubChemCrawler" title="Permalink"></a></h1><p>PubChemCrawler makes it easier to search the <a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem database</a> from Julia. You can use it to access information about particular compounds or query substructures.</p><p>The package supports only a subset of the available <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest">functionality</a>, but it is fairly straightforward to expand to other types of query. Pull requests are welcome! If you do want to make improvements to this package, this <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest-tutorial">tutorial</a> might help you get started.</p><h2 id="Before-you-start:-be-aware-of-search-limits"><a class="docs-heading-anchor" href="#Before-you-start:-be-aware-of-search-limits">Before you start: be aware of search limits</a><a id="Before-you-start:-be-aware-of-search-limits-1"></a><a class="docs-heading-anchor-permalink" href="#Before-you-start:-be-aware-of-search-limits" title="Permalink"></a></h2><p>PubChem places significant limits on requests:</p><ul><li>No more than 5 requests per second</li><li>No more than 400 requests per minute</li><li>No longer than 300 second running time per minute</li><li>Requests made via REST time out after 30s. The PUG XML interface does not have this limitation. For substructure searches, <a href="#PubChemCrawler.query_substructure_pug"><code>query_substructure_pug</code></a> is recommended.</li></ul><h2 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h2><p>Some queries make use of the CID, the <strong>C</strong>ompound <strong>ID</strong>entifier, which you can obtain in a variety of ways. Let&#39;s get the CID for aspirin:</p><pre><code class="language-julia">julia&gt; cid = get_cid(name=&quot;aspirin&quot;)
2244

julia&gt; cid = get_cid(smiles=&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;)   # use the SMILES string
2244</code></pre><p>You can then retrieve individual properties:</p><pre><code class="language-julia">julia&gt; smiles = chomp(String(get_for_cids(2244, properties=&quot;CanonicalSMILES&quot;, output=&quot;TXT&quot;)))
&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;</code></pre><p>or a list of properties:</p><pre><code class="language-julia">julia&gt; using CSV, DataFrames

julia&gt; df = CSV.File(get_for_cids(2244; properties=&quot;MolecularFormula,MolecularWeight,XLogP,IsomericSMILES&quot;, output=&quot;CSV&quot;)) |&gt; DataFrame
1×5 DataFrame
│ Row │ CID   │ MolecularFormula │ MolecularWeight │ XLogP   │ IsomericSMILES           │
│     │ $Int │ String           │ Float64         │ Float64 │ String                   │
├─────┼───────┼──────────────────┼─────────────────┼─────────┼──────────────────────────┤
│ 1   │ 2244  │ C9H8O4           │ 180.16          │ 1.2     │ CC(=O)OC1=CC=CC=C1C(=O)O │</code></pre><p>You can query properties for a whole list of <code>cids</code>.</p><p>You can also download structure data and save it to a file. This saves a 3d conformer for aspirin:</p><pre><code class="language-julia">julia&gt; open(&quot;/tmp/aspirin.sdf&quot;, &quot;w&quot;) do io
           write(io, get_for_cids(2244, output=&quot;SDF&quot;, record_type=&quot;3d&quot;))
       end
3637</code></pre><p>Finally, you can perform substructure searches. Let&#39;s retrieve up to 10 <a href="https://en.wikipedia.org/wiki/Bicyclic_molecule">bicyclic</a> compounds using a <a href="https://en.wikipedia.org/wiki/SMILES_arbitrary_target_specification">SMARTS</a> search:</p><pre><code class="language-julia">julia&gt; cids = query_substructure_pug(smarts = &quot;[\$([*R2]([*R])([*R])([*R]))].[\$([*R2]([*R])([*R])([*R]))]&quot;, maxhits = 10)
┌ Warning: maxhits was hit, results are partial
└ @ PubChemCrawler ~/.julia/dev/PubChemCrawler/src/pugxml.jl:164
10-element Vector{$Int}:
 135398658
   5280795
      5430
      5143
  54675779
   5280961
   5280804
   5280793
   5280343
   3034034</code></pre><p>Note that Julia (not this package) requires the SMARTS string characters <code>$</code> be escaped.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Queries"><a class="docs-heading-anchor" href="#Queries">Queries</a><a id="Queries-1"></a><a class="docs-heading-anchor-permalink" href="#Queries" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.get_cid" href="#PubChemCrawler.get_cid"><code>PubChemCrawler.get_cid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cid = get_cid(name=&quot;glucose&quot;)
cid = get_cid(smiles=&quot;C([C@@H]1[C@H]([C@@H]([C@H](C(O1)O)O)O)O)O&quot;)</code></pre><p>Return the PubChem <strong>c</strong>ompound <strong>id</strong>entification number for the specified compound.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/f644e4f59e46c8bd612bed0c6e8d934692a3be61/src/query.jl#LL3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.query_substructure_pug" href="#PubChemCrawler.query_substructure_pug"><code>PubChemCrawler.query_substructure_pug</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cids = query_substructure_pug(;cid=nothing, smiles=nothing, smarts=nothing,        # specifier for the substructure to search for
                               maxhits=200_000, poll_interval=10)</code></pre><p>Retrieve a list of compounds containing a substructure specified via its <code>cid</code>, the SMILES string, or a SMARTS string.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; using PubChemCrawler

julia&gt; cids = query_substructure_pug(smarts=&quot;[r13]Br&quot;)   # query brominated 13-atom rings
66-element Vector{Int64}:
  54533707
 153064026
 152829033
...</code></pre><p>PUG searches can take a while to run (they poll for completion), but conversely they allow more complex, long-running searches to succeed. See also <a href="#PubChemCrawler.query_substructure"><code>query_substructure</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/f644e4f59e46c8bd612bed0c6e8d934692a3be61/src/pugxml.jl#LL3-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.query_substructure" href="#PubChemCrawler.query_substructure"><code>PubChemCrawler.query_substructure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">msg = query_substructure(;cid=nothing, smiles=nothing, smarts=nothing,           # specifier for the substructure to search for
                          properties=&quot;MolecularFormula,MolecularWeight,XLogP,&quot;,  # properties to retrieve
                          output=&quot;CSV&quot;)                                          # output format</code></pre><p>Perform a substructure search of the entire database. You can specify the target via its <code>cid</code>, the SMILES string, or a SMARTS string. Specify the <code>properties</code> you want to retrieve as a comma-separated list from among the choices in http://pubchemdocs.ncbi.nlm.nih.gov/pug-rest, &quot;Compound Property Tables&quot;. Requesting more properties takes more time.</p><p>The output is a <code>Vector{UInt8}</code>. For <code>output=&quot;CSV&quot;</code>, a good choice to generate a manipulable result is <code>DataFrame(CSV.File(msg))</code> from the DataFrames and CSV packages, respectively. Alternatively <code>String(msg)</code> will convert it to a string, which you can write to a file.</p><p><strong>Example</strong></p><pre><code class="language-none">julia&gt; using PubChemCrawler, CSV, DataFrames

julia&gt; cid = get_cid(name=&quot;estriol&quot;)
5756

julia&gt; df = CSV.File(query_substructure(;cid)) |&gt; DataFrame      # on Julia 1.0, use `(;cid=cid)`
11607×4 DataFrame
│ Row  │ CID       │ MolecularFormula │ MolecularWeight │ XLogP    │
│      │ Int64     │ String           │ Float64         │ Float64? │
├──────┼───────────┼──────────────────┼─────────────────┼──────────┤
│ 1    │ 5756      │ C18H24O3         │ 288.4           │ 2.5      │
│ 2    │ 5281904   │ C24H32O9         │ 464.5           │ 1.1      │
│ 3    │ 27125     │ C18H24O4         │ 304.4           │ 1.5      │
...</code></pre><p>will query for derivatives of <a href="https://en.wikipedia.org/wiki/Estriol">estriol</a>.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>For complex queries that risk timing out, consider <a href="#PubChemCrawler.query_substructure_pug"><code>query_substructure_pug</code></a> in combination with <a href="#PubChemCrawler.get_for_cids"><code>get_for_cids</code></a>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/f644e4f59e46c8bd612bed0c6e8d934692a3be61/src/query.jl#LL19-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.get_for_cids" href="#PubChemCrawler.get_for_cids"><code>PubChemCrawler.get_for_cids</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">msg = get_for_cids(cids; properties|xrefs|cids_type|record_type, output=&quot;CSV&quot;)</code></pre><p>Retrieve the given <code>properties</code>, <code>xrefs</code>, CIDs, or records, respectively, for a list of compounds specified by their <code>cids</code>. The documentation for these traits can be found at http://pubchemdocs.ncbi.nlm.nih.gov/pug-rest; this URL will be referred to as PUGREST below.</p><ul><li><code>properties</code> include structural features like the molecular formula, number of undefined stereocenters, and so on. Specify these as a comma-separated list from among the choices in PUGREST under &quot;Compound Property Tables&quot;.</li><li><code>xrefs</code> (&quot;cross-references&quot;) include identifiers used by other databases, e.g., the CAS (Registry) number, PubMedID, and so on. The supported values for <code>xrefs</code> are available at PUGREST under &quot;XRefs&quot;.</li><li><code>cids_type</code> is used to retrieve CIDs for compounds related to those specified in <code>cids</code>; see PUGREST under &quot;SIDS / CIDS / AIDS&quot;.</li><li><code>record_type</code> is used to retrieve data files and to specify options for these files, e.g., 2d or 3d SDF files. See PUGREST under &quot;Full-record Retrieval&quot;.</li></ul><p><code>output</code> specifies the output format. Not all options are applicable to all queries; for example, &quot;CSV&quot; is appropriate for <code>properties</code> queries but &quot;SDF&quot; might be used for a <code>record_type</code> query. See PUGREST, &quot;Output&quot;.</p><p><strong>Examples</strong></p><pre><code class="language-none">julia&gt; using PubChemCrawler, CSV, DataFrames, JSON3

julia&gt; cids = [get_cid(name=&quot;cyclic guanosine monophosphate&quot;), get_cid(name=&quot;aspirin&quot;)]
2-element Array{Int64,1}:
 135398570
      2244

julia&gt; CSV.File(get_for_cids(cids; properties=&quot;MolecularFormula,XLogP&quot;, output=&quot;CSV&quot;)) |&gt; DataFrame
2×3 DataFrame
 Row │ CID        MolecularFormula  XLogP
     │ Int64      String            Float64
─────┼──────────────────────────────────────
   1 │ 135398570  C10H12N5O7P          -3.4
   2 │      2244  C9H8O4                1.2

julia&gt; open(&quot;/tmp/aspirin_3d.sdf&quot;, &quot;w&quot;) do io    # save the 3d SDF file for aspirin (CID 2244)
           write(io, get_for_cids(2244; record_type=&quot;3d&quot;, output=&quot;SDF&quot;))
       end
4055

julia&gt; dct = JSON3.read(get_for_cids(cids; xrefs=&quot;RN,&quot;, output=&quot;JSON&quot;));   # get the Registry Number(s) (CAS)

julia&gt; dct[:InformationList][:Information]
2-element JSON3.Array{JSON3.Object,Array{UInt8,1},SubArray{UInt64,1,Array{UInt64,1},Tuple{UnitRange{Int64}},true}}:
 {
   &quot;CID&quot;: 135398570,
    &quot;RN&quot;: [
            &quot;40732-48-7&quot;,
            &quot;7665-99-8&quot;
          ]
}
 {
   &quot;CID&quot;: 2244,
    &quot;RN&quot;: [
            &quot;11126-35-5&quot;,
            &quot;156865-15-5&quot;,
            &quot;50-78-2&quot;,
            &quot;52080-78-1&quot;,
            &quot;921943-73-9&quot;,
            &quot;98201-60-6&quot;,
            &quot;99512-66-0&quot;
          ]
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/f644e4f59e46c8bd612bed0c6e8d934692a3be61/src/query.jl#LL79-L144">source</a></section></article><h3 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.parse_formula" href="#PubChemCrawler.parse_formula"><code>PubChemCrawler.parse_formula</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">atomcounts = parse_formula(str::AbstractString)</code></pre><p>Parse <code>str</code> as a chemical formula, return a list of <code>atom=&gt;multiplicity</code> pairs.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; parse_formula(&quot;C2CaH2O6&quot;)
4-element Array{Pair{String,Int64},1}:
  &quot;C&quot; =&gt; 2
 &quot;Ca&quot; =&gt; 1
  &quot;H&quot; =&gt; 2
  &quot;O&quot; =&gt; 6</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/f644e4f59e46c8bd612bed0c6e8d934692a3be61/src/utils.jl#LL28-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.atomregex" href="#PubChemCrawler.atomregex"><code>PubChemCrawler.atomregex</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rex = atomregex(chemicalsymbol)</code></pre><p>Create a regular expression for detecting how many atoms of type <code>chemicalsymbol</code> are in a molecular formula.</p><p><strong>Examples</strong></p><p>The formula for calcium bicarbonate is Ca(HCO3)2, i.e., C2CaH2O6.</p><pre><code class="language-julia-repl">julia&gt; match(atomregex(&quot;C&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;C2&quot;, 1=&quot;2&quot;)

julia&gt; match(atomregex(&quot;Ca&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;Ca&quot;, 1=&quot;&quot;)

julia&gt; match(atomregex(&quot;H&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;H2&quot;, 1=&quot;2&quot;)

julia&gt; match(atomregex(&quot;O&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;O6&quot;, 1=&quot;6&quot;)</code></pre><p>Note that the regex for <code>&quot;C&quot;</code> does not match <code>&quot;Ca&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/f644e4f59e46c8bd612bed0c6e8d934692a3be61/src/utils.jl#LL1-L25">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 7 December 2020 14:18">Monday 7 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
